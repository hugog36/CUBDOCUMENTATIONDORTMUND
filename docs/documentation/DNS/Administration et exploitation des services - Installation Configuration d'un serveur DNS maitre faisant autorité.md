# Mise en place d‚Äôun serveur DNS autoritaire ‚Äì Solution Dortmund

**Auteur :** Hugo Guignard  
**Solution :** Dortmund  
**Contexte :** CUB - DNS Autoritaire  
**Formation :** BTS SIO SISR 2025/2026  

---

## üéØ Objectif

Mettre en place un **serveur DNS autoritaire** sous **Debian 12** (solution Dortmund), permettant de g√©rer une zone de domaine interne et d'assurer la r√©solution locale pour ce domaine.

---

## üß± 1. Pr√©paration de l‚Äôenvironnement

### √âtape 1 ‚Äì Mise √† jour du syst√®me
Avant toute installation, on met √† jour le serveur :

```bash
sudo apt update && sudo apt upgrade -y
```

![Mise √† jour du syst√®me](./images/update_upgrade.png)

---

### √âtape 2 ‚Äì Installation des paquets n√©cessaires
Installer le service **BIND9** (Berkeley Internet Name Domain), utilis√© pour la gestion DNS :

```bash
sudo apt install bind9 bind9utils bind9-doc -y
```

![Installation de BIND9](./images/install_bind9.png)

---

### √âtape 3 ‚Äì V√©rification de l‚Äô√©tat du service
S‚Äôassurer que le service est actif :

```bash
sudo systemctl status bind9
```

![Service BIND9 actif](./images/status_bind9.png)

---

## ‚öôÔ∏è 2. Configuration du serveur DNS autoritaire

### √âtape 4 ‚Äì D√©finir la zone Dortmund

√âditer le fichier principal de configuration BIND :

```bash
sudo nano /etc/bind/named.conf.local
```

Ajouter la zone pour le domaine **dortmund.local** :

```bash
zone "dortmund.local" {
    type master;
    file "/etc/bind/db.dortmund.local";
};
```

![Configuration de la zone](./images/named_conf_local.png)

---

### √âtape 5 ‚Äì Cr√©er le fichier de zone

Copier le mod√®le de zone par d√©faut et le modifier :

```bash
sudo cp /etc/bind/db.local /etc/bind/db.dortmund.local
sudo nano /etc/bind/db.dortmund.local
```

Modifier le contenu :

```bash
$TTL    604800
@       IN      SOA     ns.dortmund.local. admin.dortmund.local. (
                              2025102901 ; Serial
                              604800     ; Refresh
                              86400      ; Retry
                              2419200    ; Expire
                              604800 )   ; Negative Cache TTL
;
@       IN      NS      ns.dortmund.local.
ns      IN      A       192.168.1.10
srv1    IN      A       192.168.1.20
```

![Fichier de zone Dortmund](./images/db_dortmund_local.png)

---

### √âtape 6 ‚Äì Configurer la zone inverse

√âditer `/etc/bind/named.conf.local` √† nouveau :

```bash
zone "1.168.192.in-addr.arpa" {
    type master;
    file "/etc/bind/db.192";
};
```

Cr√©er le fichier de zone inverse :

```bash
sudo cp /etc/bind/db.127 /etc/bind/db.192
sudo nano /etc/bind/db.192
```

Contenu du fichier :

```bash
$TTL    604800
@       IN      SOA     ns.dortmund.local. admin.dortmund.local. (
                              2025102901
                              604800
                              86400
                              2419200
                              604800 )
;
@       IN      NS      ns.dortmund.local.
10      IN      PTR     ns.dortmund.local.
20      IN      PTR     srv1.dortmund.local.
```

![Zone inverse](./images/db_reverse_zone.png)

---

## üß© 3. V√©rification et validation

### √âtape 7 ‚Äì V√©rifier la configuration BIND

```bash
sudo named-checkconf
sudo named-checkzone dortmund.local /etc/bind/db.dortmund.local
sudo named-checkzone 1.168.192.in-addr.arpa /etc/bind/db.192
```

![V√©rification de la configuration](./images/check_zone.png)

---

### √âtape 8 ‚Äì Red√©marrer le service

```bash
sudo systemctl restart bind9
sudo systemctl enable bind9
```

![Red√©marrage du service](./images/restart_bind9.png)

---

## üîç 4. Tests de fonctionnement

### √âtape 9 ‚Äì Tester la r√©solution locale

Sur le serveur :

```bash
dig @localhost dortmund.local
dig @localhost ns.dortmund.local
```

![Test dig Dortmund](./images/dig_dortmund.png)

---

### √âtape 10 ‚Äì Tester depuis un client

Sur un poste client configur√© avec le DNS Dortmund :

```bash
nslookup dortmund.local 192.168.1.10
```

![Test nslookup client](./images/nslookup_client.png)

---

## üß± 5. S√©curisation et logs

### √âtape 11 ‚Äì Configurer les logs DNS

√âditer AppArmor et Bind :

```bash
sudoedit /etc/apparmor.d/usr.sbin.named
```

Ajouter cette ligne :
```
/var/log/bind.log rw,
```

Puis red√©marrer le service AppArmor :

```bash
sudo systemctl reload apparmor
```

![Configuration AppArmor](./images/apparmor_bind.png)

---

## ‚úÖ Conclusion

La solution **Dortmund** assure une gestion compl√®te et stable d‚Äôun serveur DNS autoritaire sous Debian.  
Le service **BIND9** permet la gestion des zones directes et inverses, la tra√ßabilit√© via les logs, et la compatibilit√© avec les clients du r√©seau interne.

---

**Fin du document**  
_BTS SIO SISR 2025/2026 - Solution Dortmund_
